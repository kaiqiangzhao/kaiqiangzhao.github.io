<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://kaiqiangzhao.github.io</id>
    <title>OOK</title>
    <updated>2020-04-23T15:27:57.337Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://kaiqiangzhao.github.io"/>
    <link rel="self" href="https://kaiqiangzhao.github.io/atom.xml"/>
    <subtitle>Simpler life, Deeper mind.</subtitle>
    <logo>https://kaiqiangzhao.github.io/images/avatar.png</logo>
    <icon>https://kaiqiangzhao.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, OOK</rights>
    <entry>
        <title type="html"><![CDATA[python中的__hash__和 __eq__]]></title>
        <id>https://kaiqiangzhao.github.io/post/python中的__hash__和__eq__/</id>
        <link href="https://kaiqiangzhao.github.io/post/python中的__hash__和__eq__/">
        </link>
        <updated>2020-04-23T00:46:27.000Z</updated>
        <summary type="html"><![CDATA[<p>python中dict和set的原理是哈希，其背后的实现依靠的是<code>__hash__()</code>和<code>__eq__()</code>方法，本篇文章将会讲解二者在python的dict和set使用，以及如何在自定义类中使用这两个方法。</p>
]]></summary>
        <content type="html"><![CDATA[<p>python中dict和set的原理是哈希，其背后的实现依靠的是<code>__hash__()</code>和<code>__eq__()</code>方法，本篇文章将会讲解二者在python的dict和set使用，以及如何在自定义类中使用这两个方法。</p>
<!-- more -->
<p><strong>Tips:散列表其实是一个稀疏数组，python会设法保证数组内1/3的元素是空的，当快要达到这个阈值的时候，原有的散列表会被复制到一个更大的空间，所以dict和set往往会占用大量内存，如果不是一定需要使用这两类的数据结构，可以使用元组和列表</strong></p>
<p>先看一个正常的哈希自定义类创建的对象，python3中这个类继承了object的<code>__hash__()</code>方法，hash函数调用的其实就是类的<code>__hash__()</code>方法</p>
<pre><code class="language-python">class HashTest1:
    pass

ht1 = HashTest1()
print(ht1.__hash__)  # &lt;method-wrapper '__hash__' of HashTest1 object at 0x10e112190&gt;
print(hash(ht1))  # 283185689
</code></pre>
<p>那自定义类的<code>__eq__()</code>和<code>__hash__()</code>有什么关系呢?<br>
如果自定义重载了<code>__eq__()</code>方法, 但没有重载<code>__hash__()</code>, 会将<code>__hash__</code>重置为None</p>
<pre><code class="language-python">class HashTest2:
    def __eq__(self, other):
        if id(self) == id(other):
            return True
        else:
            return False


ht2 = HashTest2()
print(ht2.__hash__)  # Output: None
# print(hash(ht2))  # Output: TypeError: unhashable type: 'HashTest1'
</code></pre>
<p>上面的代码都是在python3下的，python2和python3下的机制有些不同。<br>
python3的自定义类会默认继承object<br>
python2的自定义的类没有继承object新式类的时候, 会出现和python3相同的问题。<br>
但当python2的自定义类继承了object, 重载了<code>__eq__()</code>方法, 但没有重载<code>__hash__()</code>, 依旧可以<br>
hash成功<br>
旧式类是没有<code>__hash__</code>, 子类如果想使用<code>__hash__</code>, 必须重写<br>
新式类有<code>__hash__</code>, 子类重载了<code>__eq__()</code>方法, 但没有重载<code>__hash__()</code>, 不会将<code>__hash__</code>重置为None, 可以使用父类的<code>__hash__</code></p>
<pre><code class="language-python"># python2 测试
class OldCls():
    pass

class NewCls(object):
    pass

print(type(OldCls()))   # &lt;type 'instance'&gt;
print(type(NewCls()))   # &lt;class '__main__.NewCls'&gt;

print(OldCls().__hash__)  # AttributeError: OldCls instance has no attribute '__hash__'
print(NewCls().__hash__)  # &lt;method-wrapper '__hash__' of NewCls object at 0x10a3349d0&gt;
</code></pre>
<p>python中哈希集有：set, frozenset, dict<br>
谈到哈希集还需要说明python中的可变对象和不可变对象<br>
可变对象: list, dict, set<br>
不可变对象: tuple, string, int, float, bool</p>
<ol>
<li>如果一个对象是不可哈希的, 即没有定义<code>__hash__</code>方法, 其不可被用作哈希集的项</li>
<li>如果一个对象是可变的, 不管是否实现了<code>__eq__()</code>方法, 都不应该实现<code>__hash__()</code>，因为哈希集要求键是不可变的(如果对象的哈希值发生改变，它将处于错误的哈希桶中)</li>
</ol>
<ul>
<li>如果一个对象是不可哈希的, 即没有定义<code>__hash__</code>方法, 其不可被用作哈希集的项</li>
</ul>
<pre><code class="language-python">class HashTest3:
    __hash__ = None

    def __init__(self):
        # 将实例的__hash__赋值为None, 是不起作用的, 需要在类内定义
        # self.__hash__ = None
        pass

ht3 = HashTest3()
global_dict = dict()
global_dict[ht3] = &quot;ht3_value&quot;  # Output: TypeError: unhashable type: 'HashTest3'
</code></pre>
<p><strong>注意：</strong><br>
用户自定义的类默认带有<code>__eq__()</code>和 <code>__hash__()</code> 方法(从父类继承)；<br>
使用它们与任何对象（自己除外）比较必定不相等，只能自己等于自己,<br>
并且<code>x.__hash__()</code>会返回一个恰当的值以确保 <code>x == y</code>同时意味着 <code>x is y</code> 且<code>hash(x) == hash(y)</code><br>
所以自己重写<code>__eq__</code>和<code>__hash__</code>也需要注意, 一旦<code>x==y</code>, 就必须保证<code>hash(x) == hash(y)</code></p>
<ul>
<li>如果一个对象是可变的, 不管是否实现了<code>__eq__()</code>方法, 都不应该实现<code>__hash__()</code></li>
</ul>
<p>没有实现<code>__eq__</code>: 一旦出现bug, 很难被定位排查，这里的<code>__eq__</code>是继承父类的, 只有自己等于自己, 才返回True, 所以, ht4和ht4_1是不相等的, 对应不同的key</p>
<pre><code class="language-python">class HashTest4(list):
    HASHKEY = &quot;hash_key&quot;

    def __hash__(self):
        return hash(self.HASHKEY)


ht4 = HashTest4()
ht4_1 = HashTest4()
a = ht4
ht4.append(1)
b = ht4
ht4.append(2)
print(a, b)  # [1, 2] [1, 2]
c = ht4_1
global_dict = dict()
global_dict[a] = 1
global_dict[b] = 2
global_dict[c] = 3
print(global_dict)  # {[1, 2]: 2, []: 3}

ht4_str = &quot;ht4_str&quot;
a = ht4_str
ht4_str = &quot;new_ht4_str&quot;
b = ht4_str
print(a, b)  # ht4_str new_ht4_str

global_dict = dict()
global_dict[a] = 1
global_dict[b] = 2
print(global_dict)  # {'ht4_str': 1, 'new_ht4_str': 2}
</code></pre>
<p>实现了<code>__eq__</code>：哈希集判断两个key是否相等, 需要满足hash值相同和eq执行后的结果相同</p>
<pre><code>class HashTest5:
    HASHKEY = &quot;hash_key&quot;

    def __init__(self, val):
        self.val = val

    def __hash__(self):
        return hash(self.HASHKEY)

    def __eq__(self, other):
        if self.val == other.val:
            return True
        else:
            return False

ht5_1 = HashTest5(1)
ht5_2 = HashTest5(1)
ht5_3 = HashTest5(2)

global_dict = dict()
global_dict[ht5_1] = 1
global_dict[ht5_2] = 2
global_dict[ht5_3] = 3
# ht5_1和ht5_2的hash值相同和eq相等, 代表是同一个key
print(global_dict)  # {&lt;__main__.HashTest5 object at 0x109dd53d0&gt;: 2, &lt;__main__.HashTest5 object at 0x109dd5450&gt;: 3}
</code></pre>
<h2 id="总结">总结</h2>
<p>所以: <code>__hash__</code>是为了找到哈希桶的位置, 如果桶内没有值, 直接存入,<br>
如果有数值, 需要<code>__eq__</code>来判断桶内的key中是否相同, 如果相同就重置, 否则开辟新的空间存数值<br>
桶内不仅记录key值也记录value值, hash是根据key找到对应的桶<br>
哈希集判断两个key是否相等, 需要满足hash值相同和eq执行后的结果相同<br>
形象的说, 就是<code>__hash__</code>方法定义如何寻找桶的位置, <code>__eq__</code>定义桶的名字是否是一样的</p>
<p><strong>__eq__的引申</strong><br>
is比较的是对象的标识(引用)，直接调用id()函数来比较两者的大小<br>
<code>==</code>比较的是对象的值，调用的是<code>__eq__()</code>方法<br>
如果一个类继承的是objects，那==比较的也是两个对象的ID，和is一样<br>
但是多数内置类型都重写了<code>__eq__()</code>方法，会考虑对象属性的值</p>
<p>参考文献：官方文档: https://docs.python.org/zh-cn/3.7/reference/datamodel.html#object.<strong>hash</strong></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[贝叶斯公式]]></title>
        <id>https://kaiqiangzhao.github.io/post/bei-xie-si-gong-shi/</id>
        <link href="https://kaiqiangzhao.github.io/post/bei-xie-si-gong-shi/">
        </link>
        <updated>2020-04-21T00:39:48.000Z</updated>
        <summary type="html"><![CDATA[<p>数学中的哲学</p>
]]></summary>
        <content type="html"><![CDATA[<p>数学中的哲学</p>
<!-- more -->
<p>在讲贝叶斯公式之前，需要先讲解两个概率公式</p>
<ul>
<li>条件概率公式</li>
<li>全概率公式</li>
</ul>
<h2 id="条件概率">条件概率</h2>
<p>下面是条件概率的公式：<br>
公式1：<code>P(A|B) = P(AB) / P(B)</code></p>
<p>若条件B的发生与否对事件A无任何影响，则可认为A，B两个事件独立。<br>
P(A|B) 表示在B发生的前提下发生A的概率，若A，B两个事件独立，<code>P(A) = P(A|B)</code><br>
公式2：<code>P(A) = P(A|B)</code></p>
<p>由公式1和2可以推出公式3：<code>P(AB) = P(A)P(B)</code><br>
公式3是概率的乘法公式，也是<strong>独立性</strong>的定义</p>
<pre><code>事件间的独立性和互斥是不同的概念：
例如：
抛硬币一次：出现正面和出现反面就是互斥事件；
抛硬币两次：第一次的结果不会影响第二次的抛掷结果，这是独立事件
</code></pre>
<p>独立事件满足概率的乘法定理，即概率相乘求独立。<br>
互斥事件满足概率的加法定理，即概率相加求互斥。</p>
<h2 id="全概率公式">全概率公式</h2>
<p>设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">B_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">B_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>...<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">B_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为有限个或无限个事件，他们两两互斥，且每次实验中至少发生一个<br>
用公式表示为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> * <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">B_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">\emptyset</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">∅</span></span></span></span>(不可能事件) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mi mathvariant="normal">≠</mi><mi>j</mi></mrow><annotation encoding="application/x-tex">i \neq j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span></p>
<p>若 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">B_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> + <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">B_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> + ... + <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">B_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Ω</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Ω</span></span></span></span> (必然事件)， 则称 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>B</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">B_{1},B_{2},...,B_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为一个完备的事业群</p>
<p>于是乎：<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><mi>A</mi><mi mathvariant="normal">Ω</mi><mo>=</mo><mi>A</mi><msub><mi>B</mi><mn>1</mn></msub><mo>+</mo><mi>A</mi><msub><mi>B</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mi>A</mi><msub><mi>B</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A = A\Omega = AB_{1} + AB_{2} + ... + AB_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>A</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><mi>A</mi><msub><mi>B</mi><mn>1</mn></msub><mo>)</mo><mo>+</mo><mi>P</mi><mo>(</mo><mi>A</mi><msub><mi>B</mi><mn>2</mn></msub><mo>)</mo><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mi>P</mi><mo>(</mo><mi>A</mi><msub><mi>B</mi><mi>n</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(A) = P(AB_{1}) + P(AB_{2}) + ... + P(AB_{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>再由条件概率公式 <code>P(A|B) = P(AB) / P(B)</code> 变形得出</p>
<p><code>P(AB) = P(A|B) * P(B) = P(B|A) * P(A)</code>：</p>
<p>于是有：<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>A</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>B</mi><mn>1</mn></msub><mo>)</mo><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><msub><mi>B</mi><mn>1</mn></msub><mo>)</mo><mo>+</mo><mi>P</mi><mo>(</mo><msub><mi>B</mi><mn>2</mn></msub><mo>)</mo><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><msub><mi>B</mi><mn>2</mn></msub><mo>)</mo><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mi>P</mi><mo>(</mo><msub><mi>B</mi><mi>n</mi></msub><mo>)</mo><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><msub><mi>B</mi><mi>n</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(A) = P(B_{1})P(A|B_{1}) + P(B_{2})P(A|B_{2}) + ... + P(B_{n})P(A|B_{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p><strong>应用场景</strong><br>
在复杂的情况下直接算P(A)不容易，但A伴随某个事件<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>发生，适当构造一组<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>往往可以简化计算。</p>
<h2 id="贝叶斯公式">贝叶斯公式</h2>
<p>在上面的公式中，我们把B称为因，A称为果，由因推果是符合我们正常逻辑的。然而贝叶斯公式却是由果推因，颇具哲学意味。</p>
<p>由条件概率和全概率公式，可推：</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>B</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>A</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><mi>A</mi><msub><mi>B</mi><mi>i</mi></msub><mo>)</mo><mi mathvariant="normal">/</mi><mi>P</mi><mo>(</mo><mi>A</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>B</mi><mi>i</mi></msub><mo>)</mo><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><msub><mi>B</mi><mi>i</mi></msub><mo>)</mo><mi mathvariant="normal">/</mi><mo>∑</mo><mi>P</mi><mo>(</mo><msub><mi>B</mi><mi>j</mi></msub><mo>)</mo><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><msub><mi>B</mi><mi>j</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(B_{i}|A) = P(AB_{i}) / P(A) = P(B_{i})P(A|B_{i}) / \sum P(B_{j})P(A|B_{j})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>由公式可以看出，<code>由果推因</code> 全部转换为了 <code>由因推果</code></p>
<p>因为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是原因，其发生概率已知，我们P(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 称为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的先验概率。<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>B</mi><mi mathvariant="normal">∣</mi><mi>A</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(B|A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord">∣</span><span class="mord mathdefault">A</span><span class="mclose">)</span></span></span></span>是已知B发生后，A的条件概率。也由于得自B的取值而被称作A的后验概率。</p>
<p>贝叶斯公式就是现在有一个结果A发生了，在众多可能的原因中找到底哪个原因导致了这个结果。</p>
<p>举个例子：<br>
假设现在有三个盒子C1，C2, C3。其中C1里面有80个白球，10个黑球，10个红球。C2中有10个白球，10个黑球，10个红球。C3中有10个白球，80个黑球，10个红球。</p>
<p>设事件<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为抽对应下标的盒子，事件A为抽出的球是白球<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>B</mi><mn>1</mn></msub><mo>)</mo><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">P(B_{1}) = 1/3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">3</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>B</mi><mn>2</mn></msub><mo>)</mo><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">P(B_{2}) = 1/3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">3</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>B</mi><mn>3</mn></msub><mo>)</mo><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">P(B_{3}) = 1/3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">3</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><msub><mi>B</mi><mn>1</mn></msub><mo>)</mo><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">P(A|B_{1}) = 0.8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><msub><mi>B</mi><mn>2</mn></msub><mo>)</mo><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">P(A|B_{2}) = 0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><msub><mi>B</mi><mn>3</mn></msub><mo>)</mo><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">P(A|B_{3}) = 0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>B</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><mi>A</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><msub><mi>B</mi><mn>1</mn></msub><mo>)</mo><mi mathvariant="normal">/</mi><mo>∑</mo><mi>P</mi><mo>(</mo><msub><mi>B</mi><mi>j</mi></msub><mo>)</mo><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><msub><mi>B</mi><mi>j</mi></msub><mo>)</mo><mo>=</mo><mn>0.8</mn><mo>∗</mo><mo>(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>3</mn><mo>)</mo><mi mathvariant="normal">/</mi><mo>(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>3</mn><mo>)</mo><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">P(B_{1}|A) = P(A|B_{1}) / \sum P(B_{j})P(A|B_{j}) = 0.8*(1/3)/(1/3) = 0.8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord">3</span><span class="mclose">)</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>B</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><mi>A</mi><mo>)</mo><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">P(B_{2}|A) = 0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>B</mi><mn>3</mn></msub><mi mathvariant="normal">∣</mi><mi>A</mi><mo>)</mo><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">P(B_{3}|A) = 0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span></p>
<p>所以现在假设我们抽出一个球是白色的，则这个白球来自于哪个盒子呢？<br>
答案就是概率最大的C1。</p>
<h2 id="朴素贝叶斯">朴素贝叶斯</h2>
<p>P(B|A) = P(A|B)P(B) / P(A)</p>
<p>也就是</p>
<p>P(类别|特征) = P(特征|类别)P(类别) / P(特征)</p>
<p>其中B是类别，各个类别直接互斥，具有先验概率<br>
<strong>似然</strong>指的是用频率去代替概率，我们需要的数据集，包括特征和类别，从中统计某个类别出现的次数来表示其概率，这也是我们为什么需要大量的数据，就是为了让频率更加接近概率。</p>
<p><strong>条件独立性假设</strong><br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub><mi mathvariant="normal">∣</mi><mi>B</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>A</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><mi>B</mi><mo>)</mo><mo>∗</mo><mi>P</mi><mo>(</mo><msub><mi>A</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><mi>B</mi><mo>)</mo><mo>∗</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>∗</mo><mi>P</mi><mo>(</mo><msub><mi>A</mi><mi>n</mi></msub><mi mathvariant="normal">∣</mi><mi>B</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(A_{1}, A_{2}, ..., A_{n} | B) = P(A_{1}|B) * P(A_{2}|B) *...*P(A_{n}|B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></p>
<p>朴素贝叶斯有一个极强的假设就是各个特征间互相独立，例如，年龄，收入，学历，虽然现实中某些特征具有联系，也就是非独立的，但如果不这样假设，会出现大量的可组合类别，计算机就无法进行计算了。</p>
<p>假设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_{1}, A_{2}, ..., A_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的取值有两种可能<br>
如果条件不独立，即互相之间有关系，则<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub><mi mathvariant="normal">∣</mi><mi>B</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>A</mi><mrow><mn>1</mn><mi>x</mi></mrow></msub><mo separator="true">,</mo><msub><mi>A</mi><mrow><mn>2</mn><mi>x</mi></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mrow><mi>n</mi><mi>x</mi></mrow></msub><mi mathvariant="normal">∣</mi><mi>B</mi><mo>)</mo><mo>+</mo><mi>P</mi><mo>(</mo><msub><mi>A</mi><mrow><mn>1</mn><mi>y</mi></mrow></msub><mo separator="true">,</mo><msub><mi>A</mi><mrow><mn>2</mn><mi>x</mi></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mrow><mi>n</mi><mi>x</mi></mrow></msub><mi mathvariant="normal">∣</mi><mi>B</mi><mo>)</mo><mo>+</mo><mi>P</mi><mo>(</mo><msub><mi>A</mi><mrow><mn>1</mn><mi>y</mi></mrow></msub><mo separator="true">,</mo><msub><mi>A</mi><mrow><mn>2</mn><mi>y</mi></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mrow><mi>n</mi><mi>x</mi></mrow></msub><mi mathvariant="normal">∣</mi><mi>B</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(A_{1}, A_{2}, ..., A_{n} | B) = P(A_{1x}, A_{2x}, ..., A_{nx}|B) + P(A_{1y}, A_{2x}, ..., A_{nx}|B) + P(A_{1y}, A_{2y}, ..., A_{nx}|B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></p>
<p>这样会有2的n次方的概率要求解，计算机无法满足，由于组合太多，有写特征的组合在数据集中出现的次数很少，甚至不出现，所以其概率会为0.</p>
<h2 id="总结">总结</h2>
<p>朴素贝叶斯的计算，P(A)使用全概率公式计算，P(A|B)使用条件独立性假设公式计算，P(B)就用样本数占总样本的比例来代替，就可以得到结果。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[MySQL client ran out of memory]]></title>
        <id>https://kaiqiangzhao.github.io/post/mysql-client-ran-out-of-memory/</id>
        <link href="https://kaiqiangzhao.github.io/post/mysql-client-ran-out-of-memory/">
        </link>
        <updated>2020-04-20T09:31:40.000Z</updated>
        <summary type="html"><![CDATA[<p>访问网站，调试控制台报出的504 (gateway time-out)错误</p>
]]></summary>
        <content type="html"><![CDATA[<p>访问网站，调试控制台报出的504 (gateway time-out)错误</p>
<!-- more -->
<pre><code>failed to load resource the server responded with a status of 504 (gateway time-out)
</code></pre>
<p>504 网关超时，表示服务器没有及时处理完数据，客户端主动连接断开后，客户端(如浏览器)生成的http状态码，而非服务端返回的状态码。</p>
<p>如nginx中有下面三项配置：<br>
但都是nginx和服务端的关系，即nginx要求服务端在规定时间内连接，处理，返回数据成功。</p>
<pre><code>后端服务器连接的超时时间_发起握手等候响应超时时间
nginx跟后端服务器连接超时时间(代理连接超时)
proxy_connect_timeout 60;

后端服务器数据回传时间(代理发送超时)
后端服务器数据回传时间_就是在规定时间之内后端服务器必须传完所有的数据
proxy_send_timeout 60;

连接成功后，后端服务器响应时间(代理接收超时)
连接成功后_等候后端服务器响应时间_其实已经进入后端的排队之中等候处理（也可以说是后端服务器处理请求的时间）
proxy_read_timeout 60;
</code></pre>
<p>查看nginx日志，发现nginx返回的状态码为499，对应的是 “client has closed connection”，即服务端处理时间太长，客户端关闭了连接。</p>
<p>所以归根到底，还是服务器的问题。<br>
可以分为下面两种情况：</p>
<ul>
<li>服务器接处理的这个请求慢但是可以正常处理，</li>
<li>服务器在处理这个请求的时候出现了非bug导致的异常，导致执行中断，因为是bug导致的异常会被捕获，返回给客户端其他的状态码。</li>
</ul>
<p>还是需要回归代码，需要重点关注是否有复杂的逻辑代码，以及数据库慢查询(查询语句不正确或数据量大)，或数据库异常。</p>
<p>最后发现了一条查询语句的返回了20万条的数据。<br>
在错误日志中也找到了<code>MySQL client ran out of memory</code>的报错。</p>
<p>网上很多资料说是修改mysql的配置文件my.cnf，加大缓存空间，其实我们更应该做的是优化查询语句，如是否可以通过limit减少一次查询出来的数据量。</p>
<p>mysql<a href="https://dev.mysql.com/doc/refman/8.0/en/out-of-memory.html">官网</a>也说道若要解决此问题，首先检查查询是否正确。 它返回这么多行是否合理？ 也可以使用--quick选项来避免对查询结果进行缓存，但也会加重数据库的查询负载。</p>
<h3 id="总结">总结</h3>
<ul>
<li>前端收到504超时</li>
<li>nginx的499</li>
<li>慢查询或数据错误</li>
<li>优化查询语句</li>
</ul>
<p>参考链接：https://www.lifewire.com/504-gateway-timeout-error-explained-2622941</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[动态规划分析步骤]]></title>
        <id>https://kaiqiangzhao.github.io/post/dong-tai-gui-hua-fen-xi-bu-zou/</id>
        <link href="https://kaiqiangzhao.github.io/post/dong-tai-gui-hua-fen-xi-bu-zou/">
        </link>
        <updated>2020-04-12T09:17:54.000Z</updated>
        <summary type="html"><![CDATA[<p>分析一个问题是否可以采用动态规划求解，以及如何求解</p>
]]></summary>
        <content type="html"><![CDATA[<p>分析一个问题是否可以采用动态规划求解，以及如何求解</p>
<!-- more -->
<h3 id="动态规划">动态规划</h3>
<ul>
<li>重叠子问题</li>
<li>最优子问题</li>
<li>状态转移方程</li>
<li>分析过程</li>
<li>备忘录和db table</li>
</ul>
<hr>
<h3 id="重叠子问题">重叠子问题</h3>
<p>问题可以被拆分为多个子问题</p>
<p>多个子问题存在重复求解</p>
<p>可以使用备忘录或db table</p>
<h3 id="最优子问题">最优子问题</h3>
<p>问题最优解可以被拆分为多个子问题的最优解</p>
<p>多个子问题的最优解不存在互相制约</p>
<h3 id="状态转移方程">状态转移方程</h3>
<p>问题可以被拆分为多个子问题可以使用方程表示</p>
<hr>
<h3 id="分析过程">分析过程</h3>
<p>首先要知道，动态规划一定需要遍历全部可能，并且需要递归的去遍历全部可能</p>
<ul>
<li>明确状态(确定问题可以拆分的变量, 这些变量可以传进子问题)</li>
<li>定义函数的含义(写出简单的函数结构)</li>
<li>最子问题的返回结果进行什么操作</li>
<li>确定问题边界(递归退出边界)</li>
</ul>
<ol>
<li>明确状态(变化的变量)</li>
</ol>
<p>​	   f(n) = f(n-1) + f(n-2), 那就是变量n在变化，并在子问题传递</p>
<ol start="2">
<li>定义函数含义</li>
</ol>
<p>​	   def dp(n): return res; dp函数的含义，在n的时候，返回res（int，list，dict等）</p>
<ol start="3">
<li>最子问题的返回结果进行什么操作</li>
</ol>
<p>​	  dp(n-1), dp(n-2)等返回的结果需要进行怎样的操作，加，减，比大小，取最小，取最大等</p>
<ol start="4">
<li>确定问题边界(递归退出边界)</li>
</ol>
<p>​	   n = 0，n = -1等边界值要确定，正确退出递归</p>
<hr>
<h3 id="备忘录和db-table">备忘录和db table</h3>
<p><strong>找零钱问题</strong></p>
<p>给总金额amount，从k中面值的硬币，面值为c1,c2,c3,,,，问最少需要几枚硬币凑出这个金额，如果不能凑出，算法返回-1。</p>
<p>如 k=3 ， 面值分别为1，2，5，总金额amount=11.最少需要3枚硬币凑出, 11=5+5+1。</p>
<p>问题分析：</p>
<p>想要知道11最少需要几枚硬币，则分别计算出10，8， 6最少需要的硬币数，取最小，结果+1就是答案</p>
<ol>
<li>
<p>依次类推，所以可以拆分为子问题，变量为总金额</p>
</li>
<li>
<p>定义函数dp(amount), 输入总金额，返回最少需要的硬币数</p>
</li>
<li>
<p>返回的最小硬币数，需要执行哪些操作，取最小min</p>
</li>
<li>
<p>边界，amount&lt;0, 不存在，==0. 存在</p>
</li>
</ol>
<ul>
<li>备忘录</li>
</ul>
<p>备忘录一般采用dict记录，其中的key是我们关心的变量，value是计算的结果</p>
<p>那key就是amount，计算结果就是最小个数</p>
<p>备忘录一般都是自顶向下求解，</p>
<ul>
<li>db table</li>
</ul>
<p>db table 一般使用一维，二维数组来计算，需要将数组的下标和变量进行关联，下标对应的值就是计算结果。</p>
<p>在找零钱中，下标就是备忘录的变量amount，下标对应的值就是最小个数</p>
<p>db table 一般都是自底向上求解的。</p>
<p>在找零钱中，需要先计算总金额为0元，1元，2元，最后到给定的总额度</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[分布式事务中可靠的消息投递机制]]></title>
        <id>https://kaiqiangzhao.github.io/post/fen-bu-shi-shi-wu-de-ke-kao-de-xiao-xi-tou-di-ji-zhi/</id>
        <link href="https://kaiqiangzhao.github.io/post/fen-bu-shi-shi-wu-de-ke-kao-de-xiao-xi-tou-di-ji-zhi/">
        </link>
        <updated>2020-04-11T03:03:11.000Z</updated>
        <content type="html"><![CDATA[<p>消费者消费消息告知消息队列的两种机制：<br>
自动应答机制：消费者接受到消息后，消息队列便可删除消息，消息可能处理失败<br>
手动应答机制：消息者接收到消息并成功处理了消息，消息队列才能删除消息</p>
<p>当消费者服务采取了限流措施，可能导致消息失败消费多次，从而进入死信队列，这时候需要人工干预来处理这些位于死信队列的消息。</p>
<p>按理说，手动应答机制也可以实现消息的最终一致性，但可能导致消息队列性能下降，堆积大量失败消息。且其只能保证消费者和消息队列之前的消息的可靠投递。在消息的提供者和消息队列间，有可能出现消息写入消息队列失败，这样消息就会丢失。</p>
<p>问题的关键就在于上游服务对下游服务不管不顾。</p>
<p>消息传递形成闭环，即正反向消息机制，上游要知晓下游执行结果，并采取补偿机制，从而实现最终一致性，其中可能会出现消息重复投递的情况，要保证幂等性，可查阅之前的文章。</p>
<figure data-type="image" tabindex="1"><img src="https://kaiqiangzhao.github.io/post-images/1586575437620.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[如何保证幂等性]]></title>
        <id>https://kaiqiangzhao.github.io/post/ru-he-bao-zheng-mi-deng-xing/</id>
        <link href="https://kaiqiangzhao.github.io/post/ru-he-bao-zheng-mi-deng-xing/">
        </link>
        <updated>2020-04-09T14:28:01.000Z</updated>
        <summary type="html"><![CDATA[<p>保证幂等性的四种方式</p>
]]></summary>
        <content type="html"><![CDATA[<p>保证幂等性的四种方式</p>
<!-- more -->
<ol>
<li>创建唯一索引</li>
<li>先select, 后insert</li>
<li>分布式锁(redis)</li>
<li>状态机</li>
</ol>
<hr>
<h2 id="1-创建唯一索引">1. 创建唯一索引</h2>
<p>如退款服务，调用支付服务，完成退款。<br>
可以使用退款编码作为出账流水表的唯一索引。<br>
当支付服务进行退款操作，创建出账流水时，如果已完成退款，会因为唯一索引重复而创建失败</p>
<p>如果分库分表，不同库表的唯一索引不同步，可能造成在不同的库表重复创建退款记录。</p>
<h2 id="2-先select-后insert">2. 先select, 后insert</h2>
<p>那就不能直接创建，需要先查询所有库表内有没有约束索引，没有的话再创建出账流水。</p>
<p>但是查询和插入不是原子操作，不同的线程都可以执行查询操作，然后进入同一片临界区，如常用的if语句。<br>
然后都执行了插入操作。</p>
<h2 id="3-分布式锁">3. 分布式锁</h2>
<p>插入更新操作前需要先获取到锁。此时不需要对查询加锁，因为多个线程都查询后，进入临界区，执行插入操作，没有获得锁的全部按失效处理后退出。<br>
常用有redis分布式锁。<br>
上锁命令为<code>setnx key</code>(set if not exists)<br>
去锁命令为<code>del key</code></p>
<p>redis实现分布式锁存在下面三个问题</p>
<p><strong>问题1：</strong><br>
为了避免因为异常，导致释放锁失败，需要给锁加上过期时间<code>expire key 5</code></p>
<p><strong>问题2：</strong><br>
但是这里也存在一个问题，就是<code>setnx key</code>和<code>expire key 5</code>命令中间redis服务器发生宕机，这样也可能出现死锁。<br>
可以使用一下命令，将二者绑定为原子操作<code>set key true ex 5 nx</code></p>
<p><strong>问题3：</strong><br>
还有一个问题就是，锁过期时间不能小于业务执行时间，一般的业务操作会放入消息队列里等待执行，如果<code>del key</code>操作之前锁过期了，就无法串行执行，依旧会出现非幂等数据。</p>
<h2 id="4-状态机">4. 状态机</h2>
<p>执行操作前先判断资源的状态是否符合状态流转的条件，不要在代码里面<code>if</code>判断，否则又会陷入上面第二个问题。将状态判断交给数据库，靠数据库本身的锁机制进行控制。</p>
<p><code>update order set status=1 where status=2</code></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[建站历险记]]></title>
        <id>https://kaiqiangzhao.github.io/post/jian-zhan-li-xian-ji/</id>
        <link href="https://kaiqiangzhao.github.io/post/jian-zhan-li-xian-ji/">
        </link>
        <updated>2020-04-06T08:04:49.000Z</updated>
        <summary type="html"><![CDATA[<p>个人blog建站历险记</p>
]]></summary>
        <content type="html"><![CDATA[<p>个人blog建站历险记</p>
<!-- more -->
<h2 id="自己的建站历险记">自己的建站历险记：</h2>
<ol>
<li>github page(jekyll)</li>
<li>github page((pelican)</li>
<li>namesilo购买域名</li>
<li>xxx购买香港服务器</li>
<li>搭建typecho</li>
<li>删除香港服务器</li>
<li>github page(gridea)</li>
<li>开启github page 的 https</li>
</ol>
<h2 id="说明">说明</h2>
<p>jekyll，pelican, gridea都是静态网站的生成器。</p>
<p>github page 默认选用就是jekyll<br>
pelican 的开发语言是python，无管理后台<br>
gridea 有mac，win，linux平台的管理后台<br>
typecho的搭建也不复杂，就是没有找到自己喜欢的主题，然后就删了服务器，玩完跑路。</p>
<h2 id="一些注意事项">一些注意事项：</h2>
<ul>
<li>typecho 需要安装php和nginx，注意php版本对应的php-fpm的版本</li>
<li>需要新建一个数据库，库名叫“typecho”</li>
<li>typecho文件解压编译的位置所属的用户，要有对数据库的操作权限。否则在web配置页面，会报连接数据库错误。</li>
<li>dns解析A绑定下面四个ip，<code>185.199.108.153，185.199.109.153，185.199.110.153，185.199.111.153</code>, 不要光绑定你ping出来的那个地址，因为可能会变。具体看<a href="https://help.github.com/en/github/working-with-github-pages/configuring-a-custom-domain-for-your-github-pages-site">官网</a></li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[tmux-终端复用]]></title>
        <id>https://kaiqiangzhao.github.io/post/tmux-zhong-duan-fu-yong/</id>
        <link href="https://kaiqiangzhao.github.io/post/tmux-zhong-duan-fu-yong/">
        </link>
        <updated>2018-12-17T15:16:55.000Z</updated>
        <summary type="html"><![CDATA[<p>linux 下的终端复用工具，一般用来跑后台程序，以防网络中断，退出会话，导致程序终止。</p>
]]></summary>
        <content type="html"><![CDATA[<p>linux 下的终端复用工具，一般用来跑后台程序，以防网络中断，退出会话，导致程序终止。</p>
<!-- more -->
<ol>
<li>简介</li>
<li>会话</li>
<li>窗口</li>
<li>窗格</li>
</ol>
<hr>
<h2 id="简介">简介</h2>
<p>tmux is a terminal multiplexer.(终端复用)</p>
<p>tmux是终端多路复用神器。它允许你在一个终端的多个程序之间轻松切换。</p>
<p>使用它最直观的好处就是，通过一个终端登录远程主机并运行tmux后，在其中可以开启多个控制台而无需在浪费多余的终端来连接这台远程主机。当我们在tmux中工作的时候，即使关掉连接窗口，再次连接，进入tmux和会话我们之前的工作仍然在继续</p>
<hr>
<p><strong>tmux中有三种概念：会话（session），窗口（window），窗格（pane）</strong></p>
<ul>
<li>会话有点像是tmux的服务，在后端运行，我们可以通过tmux命令创建这种服务，并且可以通过tmux命令查看，附件到后端允许的会话中。</li>
<li>一个会话可以包含多个窗口</li>
<li>一个窗口可以被分割成多个窗格</li>
</ul>
<hr>
<h2 id="会话">会话</h2>
<p>1.<strong>tmux new -s session1</strong></p>
<ul>
<li>新建一个会话，-s (session的首字母)。运行后会从终端环境进入到会话环境。</li>
<li>当进入到session之后，在下面有一条绿色的状态指示栏，example：[session]0:myserver1*</li>
<li>依次是当前会话的名字，会话中的窗口序号，以及窗口名字，窗口名字后面有一个星号*,表示是我们操作的当前窗口。</li>
</ul>
<p>2.<strong>ctrl+b d</strong></p>
<ul>
<li>退出会话，回到shell的终端环境（linux的shell、bash，termial），d是detach(脱离)，但此时tmux的程序还在后端运行。</li>
</ul>
<p>3.<strong>tmux ls</strong></p>
<ul>
<li>终端环境查看会话列表</li>
</ul>
<p>4.<strong>ctrl+b s</strong></p>
<ul>
<li>会话环境查看会话列表，且可以通过方向键选择会话并回车，在会话间进行切换</li>
</ul>
<p>5.<strong>tmux a -t session1</strong></p>
<ul>
<li>从终端环境进入会话，a字母是attach（附加）的头字母，-t 指定要进入的已存在的会话名</li>
</ul>
<p>6.<strong>tmux kill-session -t session1</strong></p>
<ul>
<li>销毁会话，可以发生在终端环境和会话环境</li>
<li>在终端直接输入即可，在会话中需要先ctrl+b :（注意冒号），然后输入命令</li>
</ul>
<p>7.<strong>tmux rename -t old_session_name new_session_name</strong></p>
<ul>
<li>重命名会话，在终端环境中</li>
</ul>
<p>8.**ctrl+b $ **</p>
<ul>
<li>重命名会话，在会话环境中</li>
</ul>
<hr>
<h2 id="窗口">窗口</h2>
<p>窗口是我们工作的最小单位</p>
<p>默认情况下，在一个window中，只有一个大窗格，占满整个窗口区域。</p>
<p>新建的会话中会默认一个窗口，该窗口名字一般是登陆终端的用户名@主机</p>
<p>1.<strong>ctrl+b c</strong></p>
<ul>
<li>创建窗口，默认情况下创建出来的窗口，由窗口序号+窗口名字组成</li>
</ul>
<p>2.<strong>ctr+b ,</strong>（不要忘记逗号）</p>
<ul>
<li>重命名窗口</li>
</ul>
<p>3.<strong>ctrl+b p/n/0/w/l</strong></p>
<ul>
<li>
<p>窗口切换</p>
</li>
<li>
<p>ctrl+b p (previous的首字母) 切换到上一个window。</p>
</li>
<li>
<p>ctrl+b n (next的首字母) 切换到下一个window。</p>
</li>
<li>
<p>ctrl+b 0 切换到0号window，依次类推，可换成任意窗口序号</p>
</li>
<li>
<p>ctrl+b w (windows的首字母) 列出当前session所有window，通过上、下键切换窗口</p>
</li>
<li>
<p>ctrl+b l (字母L的小写)相邻的window切换</p>
</li>
</ul>
<p>4.<strong>ctrl+&amp;</strong></p>
<ul>
<li>关闭当前window，会有y/n的提示</li>
</ul>
<hr>
<h2 id="窗格">窗格</h2>
<p>tmux的一个窗口，可以被分成多个pane（窗格），可以做出分屏的效果</p>
<p>1.<strong>ctrl+b %</strong></p>
<ul>
<li>垂直分屏</li>
</ul>
<p>2.<strong>ctrl+b “</strong></p>
<ul>
<li>水平分屏</li>
<li>分屏之后光标停留在哪个pane上，表示该pane是活动的，另外一般情况下当前pane会被绿色的线条围起来。一般分屏之后当前窗口名字会重置为默认窗口名字。通过多次分屏操作，我们可以得到各种样子的分屏效果</li>
</ul>
<p>3.<strong>ctrl+b o/Up/Down/Left/Right/Space/z</strong></p>
<ul>
<li>切换pane</li>
<li>ctrl+b o 依次切换当前窗口下的各个pane</li>
<li>ctrl+b Up/Down/Left/Right 根据按箭方向选择切换到某个pane</li>
<li>ctrl+b Space (空格键) 对当前窗口下的所有pane重新排列布局，每按一次，换一种样式。</li>
<li>ctrl+b z 最大化当前pane。再按一次后恢复。</li>
</ul>
<p>4.<strong>ctrl+b x</strong></p>
<ul>
<li>关闭当前使用中的pane，操作后有关闭提示</li>
</ul>
]]></content>
    </entry>
</feed>